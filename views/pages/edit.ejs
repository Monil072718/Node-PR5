<%-include('../partials/header.ejs')%>

  <div class="container">
    <h1 class="text-center">Edit Movie</h1>
    <form id="form" class="rounded px-8 pt-6 mb-4" action="" enctype="multipart/form-data" method="post" onsubmit="return handleForm(this)">

      <label class="form-lable">
        Movie Title
      </label>
      <input class="form-control" type="text" name="title" value="<%=movie.title %>" />
      <p class="text-danger" id="titlee"></p>

      <label class="form-lable">
        Description
      </label>
      <input class="form-control" type="text" name="description" value="<%=movie.description %>" />
      <p class="text-danger" id="authorError"></p>

      <label class="form-lable">
        genre
      </label>
      <select class="form-select" name="type" value="<%=movie.genre %>">
        <option value="" disabled selected>
          genre        </option>
        <option <%=movie.genre==='action' ? 'selected' : '' %> value="action">Action</option>
        <option <%=movie.genre==='comedy' ? 'selected' : '' %> value="comedy">Comedy</option>
        <option <%=movie.genre==='romance' ? 'selected' : '' %> value="romance"> Romance</option>
      </select>
      <p class="text-danger" id="booktypeError"></p>

      <label class="form-lable">
        Published Year
      </label>
      <input class="form-control" type="number" name="release_year" value="<%=movie.release_year %>" />
      <p class="text-danger" id="pyearError"></p>

      <label class="form-lable">
        Rating
      </label>
      <input class="form-control" type="number" name="rating" value="<%=movie.rating %>" />
      <p class="text-danger" id="stockError"></p>
      
      <input type="file"  name="file" id="">
      <input type="hidden" name="previous_image" value="<%=movie.image%>">
      <img src="/<%=movie.image%>" alt="" name="file" width="100px">

      <br>
      <button class="btn btn-primary" type="submit">
        Update
      </button>
    </form>
  </div>

  <%-include('../partials/footer.ejs')%>


    <script>
      function handleForm(e) {
        let submit = true;
        const title = e.title;
        const author = e.author;
        const booktype = e.type;
        const published = e.published;
        const stock = e.stock;
        const price = e.price;

        if (title.value === "") {
          document.getElementById("titlee").innerHTML = "Please enter book title";
          submit = false;
        } else {
          document.getElementById("titlee").innerHTML = "";
        }

        if (author.value === "") {
          document.getElementById("authorError").innerHTML = "Please enter book author";
          submit = false;
        } else {
          document.getElementById("authorError").innerHTML = "";
        }

        if (booktype.value === "") {
          document.getElementById("booktypeError").innerHTML = "Please select book type";
          submit = false;
        } else {
          document.getElementById("booktypeError").innerHTML = "";
        }

        if (published.value === "") {
          document.getElementById("pyearError").innerHTML = "Please enter published year";
          submit = false;
        } else {
          document.getElementById("pyearError").innerHTML = "";
        }

        if (stock.value === "") {
          document.getElementById("stockError").innerHTML = "Please enter total stock";
          submit = false;
        } else {
          document.getElementById("stockError").innerHTML = "";
        }

        if (price.value === "") {
          document.getElementById("priceError").innerHTML = "Please enter book value";
          submit = false;
        } else {
          document.getElementById("priceError").innerHTML = "";
        }

        return submit;
      }
    </script>